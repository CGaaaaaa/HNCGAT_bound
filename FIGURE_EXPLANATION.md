# 论文图片说明与复现关系

## 📊 Figure 4: 超参数敏感性分析

### 图片内容

**Figure 4 展示了三个超参数对模型性能的影响**：

1. **(a) 嵌入维度 d (embedding dimensions)**
   - 测试值：8, 16, 32, 64, 128, 256, 512
   - 最佳值：**d=64**（AUC峰值约0.965，AP峰值约0.81）
   - 说明：维度太小或太大都会降低性能

2. **(b) 对比损失权重 λ (lambda)**
   - 测试值：0.01, 0.1, 0.5, 1, 2, 10
   - 最佳值：**λ=1**（AUC峰值约0.96，AP峰值约0.81）
   - 说明：对比损失权重需要平衡

3. **(c) 温度参数 τ (temperature)**
   - 测试值：0.05, 0.1, 0.2, 0.5, 1, 10
   - 最佳值：**τ=0.1**（AUC峰值约0.96，AP峰值约0.81）
   - 说明：温度参数影响对比学习的效果

### 与你的复现的关系

**❌ 与90%训练比例无关**

- **90%训练比例** = 数据划分比例（训练集占90%）
- **Figure 4** = 超参数调优实验（测试不同超参数值）

**✅ 但你使用的参数与论文一致**：
- d = 64 ✅（论文最佳值）
- λ = 1 ✅（论文最佳值）
- τ = 0.1 ✅（论文最佳值）

**所以你的结果好是正常的**，因为你使用了论文找到的最佳超参数！

## 📊 Figure 5: 嵌入可视化

### 图片内容

**Figure 5 展示了学习到的嵌入向量的可视化**：

1. **(a) 蛋白质嵌入可视化**
   - 6个蛋白质家族：Glutathione S-transferase, bHLH, AP2 EREBP, HSF, MYB, WRKY
   - 使用UMAP降维到2D
   - **目的**：验证模型学习到的嵌入是否有生物学意义
   - **结果**：同一家族的蛋白质在嵌入空间中聚集在一起

2. **(b) 代谢物嵌入可视化**
   - 4个代谢物类别：Carbohydrate, Phenols, Amino acid derivative, Indoles
   - 使用UMAP降维到2D
   - **目的**：验证模型学习到的嵌入是否有生物学意义
   - **结果**：同一类别的代谢物在嵌入空间中聚集在一起

### 与你的复现的关系

**❌ 与90%训练比例无关**

- **90%训练比例** = 数据划分
- **Figure 5** = 嵌入可视化分析

**✅ 但你可以生成类似的图片**：
- 你的模型已经训练完成
- 可以提取嵌入向量
- 使用UMAP可视化

## 🔍 关键理解

### 90%训练比例 vs Figure 4/5

| 实验类型 | 你的复现 | Figure 4 | Figure 5 |
|---------|---------|----------|----------|
| **目的** | 性能评估 | 超参数调优 | 嵌入可视化 |
| **变量** | 训练比例(90%) | 超参数值(d,λ,τ) | 嵌入向量 |
| **关系** | ✅ 已完成 | ❌ 未做 | ❌ 未做 |
| **重要性** | ⭐⭐⭐⭐⭐ 核心结果 | ⭐⭐⭐ 补充分析 | ⭐⭐ 可视化展示 |

### 你的复现状态

**✅ 已完成（核心）**：
- 90%训练比例的实验
- 使用了最佳超参数（d=64, λ=1, τ=0.1）
- 获得了主要结果（AUC: 0.979）

**❌ 未完成（补充）**：
- Figure 4：超参数敏感性分析（需要多次运行不同超参数）
- Figure 5：嵌入可视化（需要提取嵌入并可视化）

## 💡 如果要生成这些图片

### 生成 Figure 4（超参数分析）

需要修改代码，测试不同的超参数值：

```python
# 测试不同的 d 值
for d in [8, 16, 32, 64, 128, 256, 512]:
    # 运行训练，记录AUC和AP
    # 绘制曲线

# 测试不同的 λ 值
for lamb in [0.01, 0.1, 0.5, 1, 2, 10]:
    # 运行训练，记录AUC和AP
    # 绘制曲线

# 测试不同的 τ 值
for tau in [0.05, 0.1, 0.2, 0.5, 1, 10]:
    # 运行训练，记录AUC和AP
    # 绘制曲线
```

**预计时间**：每个超参数组合需要2-3小时训练，总共约30-50小时

### 生成 Figure 5（嵌入可视化）

需要：
1. 提取训练好的模型的嵌入向量
2. 使用UMAP降维到2D
3. 根据蛋白质家族/代谢物类别着色
4. 绘制散点图

```python
import umap
import matplotlib.pyplot as plt

# 1. 加载训练好的模型
model.load_state_dict(torch.load('best_model.pkl'))

# 2. 提取嵌入
with torch.no_grad():
    _, embA, embB, embC = model(...)
    
# 3. UMAP降维
reducer = umap.UMAP(n_components=2)
protein_2d = reducer.fit_transform(embA.cpu().numpy())
metabolite_2d = reducer.fit_transform(embB.cpu().numpy())

# 4. 可视化
plt.scatter(protein_2d[:, 0], protein_2d[:, 1], c=protein_families)
plt.show()
```

**预计时间**：1-2小时（主要是数据处理和可视化）

## 📝 总结

### 关于你的问题

1. **如果复现了也是这个图片效果吗？**
   - Figure 4：需要额外做超参数分析实验
   - Figure 5：可以生成，需要提取嵌入并可视化

2. **这个图片在讲什么？**
   - Figure 4：超参数对性能的影响（找到最佳参数）
   - Figure 5：模型学习到的嵌入是否有生物学意义

3. **我复现的90%是否和这个有关？**
   - **没有直接关系**
   - 90%是训练比例（数据划分）
   - Figure 4是超参数调优
   - Figure 5是嵌入可视化
   - **但你已经使用了Figure 4找到的最佳超参数**，所以结果好是正常的！

### 建议

**对于发表论文**：
- ✅ **Figure 4不是必须的**：你已经使用了最佳超参数
- ✅ **Figure 5可以补充**：展示模型学习到的嵌入有意义（1-2小时）
- ✅ **你的90%结果已经足够**：这是核心结果

**如果要完整复现**：
- Figure 4需要大量时间（30-50小时）
- Figure 5相对简单（1-2小时）
- 建议：先做Figure 5，Figure 4可选

